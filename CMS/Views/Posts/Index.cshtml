@model List<CMS.Models.Post>

@{
    ViewBag.Title = "Posts";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="box">
    <div class="box-body">

        <table id="posts" class="table table-bordered table-hover">
            <thead>
                <tr>
                    <th>Title</th>
                    <th>Author</th>
                    <th>Categories</th>
                    <th>Data</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                @foreach (var post in Model)
                {
                    <tr>
                        <td><b>@Html.ActionLink(@post.PostTitle, "Edit", "Posts", new { id = post.Id }, new { @class = "nav-link" })</b></td>
                        <td>-</td>
                        <td>-</td>
                        <td>@post.CreatedAt</td>
                        <td>
                            <button data-postID="@post.Id" class="btn-link js-delete">Delete</button>
                        </td>
                    </tr>

                }
            </tbody>

        </table>
    </div>
</div>

@if (Model.Count == 0)
{
    <p> We don't have any customers yet.</p>
}


@section scripts {

    <script>

        $(document).ready(function () {
            $("#posts .js-delete").on("click", function () {
                var button = $(this);
                if (confirm("Are you sure you want to delete this customers?")) {
                    $.ajax({
                        url: '/api/posts/' + button.attr("data-postId"),
                        method: "DELETE",
                        success: function () {
                            console.log("success");
                            button.parents("tr").remove();
                        }
                    }).done(function () {
                        console.log("success");
                    });
                }
            });
        });


    </script>

}
